# aliyun RDS mysql serverless

## 自动启停

- 如果实例在10分钟内无连接，实例自动暂停。
- 有任何连接请求时，实例自动启动。
  > 启动过程约6~40秒，根据不同的实例库表状态会有浮动。在启动过程中，实例不可用。
- 实例停止期间仅收取存储费用，不收取计算费用。

## 计算资源

RDS MySQL Serverless计算资源的单位是RCU（RDS Capacity Unit），1个RCU约等于2GB内存及对应CPU（当前为1核2GB内存），实例计算资源会在您指定的RCU范围内自动伸缩。

当前最小0.5RCU、最大32RCU，扩缩容的粒度为0.5RCU。

## 存储资源

- RDS MySQL Serverless存储空间最小20GB，最大32TB。
- 您需要为实例指定最小存储空间。当可用存储空间不足时，存储空间自动扩容。
- 为保障实例稳定，不支持自动缩容，您可以手动缩容。缩容后的最小空间为：min{数据量*1.3, 数据量+400 GB}，且不能小于规格的最小存储空间。

## 计费

**公式：** 每小时费用 = 单节点资源使用量 x 单价 x 节点数

**单节点资源使用量：**

- **计算资源：** 以RCU（RDS Capacity Unit）为单位，1个RCU约等于1核2 GB内存，每次升降为0.5RCU的整数倍，每小时RCU使用量等于该小时内每秒RCU的平均值。

- **存储资源：** 您需要为实例指定最小存储空间。数据量小于最小存储空间时，按最小存储空间计费。可用存储空间不足时，存储空间自动扩容，按扩容后的存储空间计费。

**节点数：**

基础系列为单节点，高可用系列为双节点。

## 常见问题

1. 为什么实例没有自动停止？如何查看实例的当前连接数？
    - 自动启停功能默认关闭，需要手动开启。
    - 如果已开启，您可以查看实例的连接数。
        - 查看连接数：在实例详情页左侧，选择监控与报警，查看会话连接指标。
        - 查看有哪些连接：执行SHOW PROCESSLIST查看。
    - 如果申请了公网地址且白名单全放开，可能会被外部恶意扫描导致不会自动暂停。建议释放公网地址或修改白名单。
2. RCU升降要多久，触发条件是什么？
    - 耗时：RCU升降通常实时完成，少数情况下需要跨机迁移（2~5分钟）。高可用系列由于有备节点，发生跨机迁移的概率更低。
    - 触发条件：
        - CPU使用率和内存使用率其中一个升高至阈值时扩容。
        - CPU使用率和内存使用率两者都降低至阈值时缩容。
        - 阈值在60%~80%之间，因具体情况而异，且可能会调整以保障可用性。
3. 如何选择RCU扩缩范围？
    - 您可以采用其中一种方式：
        - 进行压测，得到最低负载和最高负载时所需的RCU数或CPU核数。
        - 按业务需要的CPU核数评估。1个RCU约等于1核2 GB内存。
